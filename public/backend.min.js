!function(){"use strict";var t=function(){function t(t){this.container=t,this.elements=Array.from(t.querySelectorAll(".widget-group-el")),this.controlsContainer=t.querySelector(".controls-bottom"),this.orderTarget=this.controlsContainer.querySelector("input[data-order]"),this.min=Number.parseInt(t.getAttribute("data-min")),this.max=Number.parseInt(t.getAttribute("data-max"))}return t.setPosition=function(t,e){t.style.order=e.toString()},t.getPosition=function(t){return Number.parseInt(t.style.order)},t.setState=function(t,e){e?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled")},t.prototype.init=function(){var e=this;Array.from(this.container.children).forEach((function(t){e.elements.includes(t)||t===e.controlsContainer||t.remove()})),t.setPosition(this.controlsContainer,this.elements.length),this.updateElementStates(),this.elements.forEach((function(n){var r=e.getButtons(n),o=r[0],i=r[1],s=r[2],a=r[3];o.addEventListener("click",(function(r){r.preventDefault();var o=t.getPosition(n);e.swap(o,o-1)})),i.addEventListener("click",(function(r){r.preventDefault();var o=t.getPosition(n);e.swap(o,o+1)})),s.addEventListener("click",(function(r){r.preventDefault();var o=t.getPosition(n);e.remove(o)})),a.addEventListener("click",(function(t){t.preventDefault(),e.updateOrderTarget(!0),n.closest("form").submit()}))}))},t.prototype.getButtons=function(t){return[t.querySelector("button[data-up]"),t.querySelector("button[data-down]"),t.querySelector("button[data-remove]"),this.controlsContainer.querySelector("button[data-add]")]},t.prototype.updateElementStates=function(){var e=this;this.elements.forEach((function(n,r){t.setPosition(n,r);var o=e.getButtons(n),i=o[0],s=o[1],a=o[2],u=o[3],c=e.elements.length;t.setState(i,0!==r),t.setState(s,c-1!==r),t.setState(a,isNaN(e.min)||c!==e.min),t.setState(u,isNaN(e.max)||c!==e.max)})),this.updateOrderTarget()},t.prototype.updateOrderTarget=function(t){void 0===t&&(t=!1);var e=this.elements.map((function(t){return Number.parseInt(t.getAttribute("data-id"))}));t&&e.push(0),this.orderTarget.value=e.join(",")},t.prototype.swap=function(t,e){var n;n=[this.elements[e],this.elements[t]],this.elements[t]=n[0],this.elements[e]=n[1],this.updateElementStates()},t.prototype.remove=function(t){this.elements[t].remove(),this.elements.splice(t,1),this.updateElementStates()},t}();document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".widget-group").forEach((function(e){new t(e).init()}))}))}();
